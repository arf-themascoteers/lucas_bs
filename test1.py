import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

selected_bands = {8: [739, 843.5, 1115.5, 1412.5, 1556, 1788.5, 2133, 2201.5],
                 16: [606, 671.5, 739, 857.5, 993, 1097, 1303.5, 1412.5, 1468, 1509, 1715.5, 1861, 2133.5, 2136, 2234.5, 2395],
                 32: [579, 600, 650, 686, 698, 744, 747.5, 890.5, 900, 1007, 1043.5, 1119, 1210, 1261.5, 1366.5, 1469.5, 1495, 1609.5,
                      1652.5, 1653.5, 1688, 1726.5, 1878.5, 1882, 2133.5, 2134.5, 2202, 2202, 2221, 2221.5, 2222, 2492],
                 64: [447, 544.5, 546, 571.5, 587, 640, 663, 688.5, 718.5, 748.5, 758, 770, 813, 813, 838, 880, 890.5, 921.5, 978.5,
                      982.5, 1013.5, 1067.5, 1108, 1162.5, 1167, 1199, 1324, 1337, 1337.5, 1368.5, 1409, 1416, 1476, 1476.5, 1527.5,
                      1529.5, 1538, 1596, 1622.5, 1726, 1726.5, 1727.5, 1734, 1790.5, 1794.5, 1890.5, 1887.5, 1921, 1923.5, 1964, 2140,
                      2144.5, 2149.5, 2152.5, 2187.5, 2190.5, 2226, 2237.5, 2238, 2376, 2377.5, 2389.5, 2413.5, 2479],
                 128: [412, 413, 413.5, 450, 457.5, 501.5, 532.5, 537, 538.5, 560, 569.5, 595.5, 596.5, 603, 647.5, 663, 698.5, 704.5,
                       712, 712.5, 731.5, 755.5, 757.5, 794.5, 796.5, 806.5, 807, 818.5, 868.5, 875, 878, 908.5, 914, 922, 928, 971,
                       984, 1020, 1033.5, 1064.5, 1082.5, 1084, 1109, 1114, 1114.5, 1142.5, 1169.5, 1187.5, 1190.5, 1202.5, 1210, 1271,
                       1279, 1280, 1303, 1306, 1306, 1324.5, 1356, 1397.5, 1397.5, 1399.5, 1403.5, 1432.5, 1468, 1471.5, 1472, 1492,
                       1494, 1526.5, 1553.5, 1561.5, 1635.5, 1636.5, 1639.5, 1664, 1667.5, 1669.5, 1684.5, 1694.5, 1698.5, 1717.5,
                       1750.5, 1751, 1785.5, 1790, 1793, 1825, 1840.5, 1878.5, 1882.5, 1886, 1893.5, 1939.5, 1948, 1964, 1965, 1979.5,
                       1992, 1992.5, 2055, 2091.5, 2093, 2093.5, 2096, 2098.5, 2140, 2140, 2147.5, 2170, 2204, 2203.5, 2225, 2227.5,
                       2238.5, 2284, 2287.5, 2296.5, 2297, 2321.5, 2363.5, 2379, 2379, 2380.5, 2380.5, 2402, 2460, 2481],
                 256: [405.5, 413, 418, 426.5, 432.5, 438.5, 441, 443.5, 443.5, 448.5, 450, 510.5, 525.5, 547.5, 548, 558.5, 562.5, 568,
                       570.5, 580, 582.5, 584, 588, 588, 590.5, 609.5, 611.5, 617, 626.5, 646, 651, 663, 672, 674.5, 678, 689.5, 706.5,
                       710, 718.5, 727.5, 735.5, 743.5, 748, 750.5, 751, 759, 781.5, 790, 797.5, 800.5, 801.5, 803, 812.5, 835.5, 838.5,
                       842.5, 845.5, 851.5, 868, 870, 880, 880, 890.5, 890.5, 903, 909, 911, 950, 955, 955, 956, 970, 985.5, 1004.5,
                       1011, 1014.5, 1019, 1021, 1034.5, 1043, 1053.5, 1059, 1062, 1072, 1073.5, 1077, 1111, 1113.5, 1120, 1121, 1126,
                       1139, 1140, 1145.5, 1181.5, 1181.5, 1183, 1193, 1195.5, 1203.5, 1209, 1244.5, 1250.5, 1251, 1251.5, 1254, 1260,
                       1265.5, 1267.5, 1272, 1291.5, 1294.5, 1294.5, 1294.5, 1296.5, 1297, 1348.5, 1355.5, 1358.5, 1381, 1400, 1400.5,
                       1403, 1410, 1412.5, 1414.5, 1453, 1469.5, 1471.5, 1472.5, 1472.5, 1475, 1476, 1475.5, 1476, 1475.5, 1522, 1531.5,
                       1536, 1556, 1562, 1573.5, 1574, 1577, 1579, 1582, 1583.5, 1587, 1587.5, 1593, 1601, 1628, 1665, 1669.5, 1674.5,
                       1675, 1675, 1677.5, 1682, 1684, 1689.5, 1693, 1725.5, 1726, 1728, 1748, 1750, 1754.5, 1756, 1758, 1758, 1763,
                       1818, 1827.5, 1852, 1854.5, 1861, 1862.5, 1861, 1860, 1861.5, 1882, 1890, 1891.5, 1892.5, 1914.5, 1930, 1935.5,
                       1938.5, 1940.5, 1959, 1960, 1963, 1964, 1968.5, 1988.5, 1990, 1990, 2009.5, 2016, 2025.5, 2026, 2035.5, 2037.5,
                       2046, 2050, 2138, 2138, 2138.5, 2138.5, 2136, 2137, 2138, 2138, 2141, 2149, 2151.5, 2163.5, 2165, 2187, 2190,
                       2197.5, 2196.5, 2201.5, 2222, 2225.5, 2225.5, 2239, 2243, 2254, 2256, 2258.5, 2263, 2266.5, 2266, 2269, 2270,
                       2271.5, 2273.5, 2357, 2359.5, 2364, 2365, 2365, 2365, 2370.5, 2373.5, 2397.5, 2406.5, 2433, 2459, 2460.5, 2464,
                       2466.5, 2472, 2492.5],
                 512: [413.5, 414, 418, 421.5, 422.5, 424, 430, 433, 446, 449.5, 450, 451, 452.5, 453.5, 454.5, 454, 455, 456.5, 460,
                       491, 495, 500, 506, 508.5, 520.5, 523, 527.5, 529, 530, 533.5, 537, 541, 547.5, 548, 552, 556.5, 559, 566, 568,
                       575, 577, 578.5, 581, 583.5, 585, 587.5, 587, 589, 598, 603.5, 604.5, 608.5, 634.5, 636.5, 640.5, 643, 645, 646,
                       645.5, 647.5, 647, 649, 652, 654, 661, 667.5, 671.5, 672, 673.5, 688.5, 690.5, 700, 702, 703.5, 704.5, 717.5,
                       720, 720.5, 723.5, 728.5, 734.5, 736, 749.5, 752.5, 759, 760, 763.5, 765.5, 766.5, 766.5, 768.5, 768, 787.5, 788,
                       789.5, 791.5, 792, 793, 797, 802, 811, 810.5, 812.5, 815.5, 819.5, 819.5, 830, 833, 833.5, 839.5, 846.5, 849.5,
                       856.5, 860, 861, 863, 864, 878.5, 880.5, 888, 889, 889, 890, 891, 895, 900, 903.5, 910.5, 913.5, 914.5, 918,
                       921.5, 924.5, 929, 937.5, 945, 949, 953, 961, 961, 968.5, 972.5, 994.5, 996, 996.5, 997.5, 999, 1002, 1006,
                       1011.5, 1020.5, 1022, 1027, 1034.5, 1035, 1037, 1037.5, 1041, 1041.5, 1045.5, 1051, 1051, 1056, 1058.5, 1064.5,
                       1064, 1066, 1066.5, 1071.5, 1084.5, 1087, 1089.5, 1094.5, 1098, 1109, 1110, 1113, 1126, 1132.5, 1134, 1136, 1137,
                       1139, 1141.5, 1142, 1148.5, 1164.5, 1166.5, 1167.5, 1168, 1168, 1181.5, 1182, 1182.5, 1182.5, 1184, 1184, 1185,
                       1185.5, 1192.5, 1192.5, 1208.5, 1211, 1212, 1214, 1231, 1250.5, 1251, 1251, 1255.5, 1263.5, 1264, 1264.5, 1266.5,
                       1269, 1269, 1273.5, 1273.5, 1276.5, 1288.5, 1290.5, 1290, 1293.5, 1293.5, 1295, 1295.5, 1298, 1309, 1323, 1335.5,
                       1337.5, 1339, 1340.5, 1344, 1344.5, 1371.5, 1386.5, 1378, 1378, 1397.5, 1398, 1399, 1395, 1403, 1403, 1404, 1408,
                       1409.5, 1410.5, 1424, 1424, 1424, 1415, 1414.5, 1444.5, 1445.5, 1452, 1453.5, 1454, 1459.5, 1462.5, 1464, 1465,
                       1467, 1482.5, 1483, 1483.5, 1494, 1506.5, 1507, 1509, 1511.5, 1512, 1513, 1513.5, 1516.5, 1517, 1518, 1522,
                       1524.5, 1526, 1526, 1526, 1530, 1530.5, 1531, 1538, 1581, 1582, 1583.5, 1584.5, 1587.5, 1590, 1592.5, 1594.5,
                       1595.5, 1597.5, 1599.5, 1600, 1601.5, 1605, 1606, 1610.5, 1610.5, 1618.5, 1623.5, 1636.5, 1636.5, 1638.5, 1639,
                       1649, 1651, 1663.5, 1666, 1666, 1669.5, 1671, 1677, 1695, 1696, 1698.5, 1699, 1700.5, 1701.5, 1702.5, 1704.5,
                       1705.5, 1706.5, 1707, 1707, 1727, 1726.5, 1728, 1741.5, 1745.5, 1746.5, 1746.5, 1747.5, 1756.5, 1756, 1774,
                       1779.5, 1782, 1783.5, 1785, 1791.5, 1801, 1806, 1807, 1808.5, 1808.5, 1813, 1818.5, 1820, 1821.5, 1855.5, 1855,
                       1854.5, 1857.5, 1858, 1860, 1860.5, 1878.5, 1884, 1887.5, 1887, 1894, 1894, 1895, 1896, 1898, 1900, 1913.5, 1917,
                       1918, 1918, 1926.5, 1926, 1934, 1943.5, 1943.5, 1947, 1956.5, 1966.5, 1968.5, 1971, 1972.5, 1972.5, 1981, 1988,
                       1995.5, 2002.5, 2003.5, 2006, 2022, 2024.5, 2027, 2028.5, 2031, 2031.5, 2033, 2034, 2035.5, 2041, 2043.5, 2049,
                       2049.5, 2051, 2052, 2064, 2068, 2073, 2074.5, 2078, 2079, 2081, 2094, 2097, 2097.5, 2101.5, 2106.5, 2110.5, 2117,
                       2120, 2123.5, 2125, 2125, 2130, 2130.5, 2131, 2140, 2149.5, 2152, 2164, 2166, 2170, 2171, 2174.5, 2174, 2174.5,
                       2178, 2180, 2180.5, 2184.5, 2188, 2218.5, 2223.5, 2226, 2228, 2228.5, 2233, 2238.5, 2240, 2241, 2243, 2245.5,
                       2254.5, 2260.5, 2260.5, 2264, 2264.5, 2269, 2275, 2275.5, 2281.5, 2279.5, 2286, 2290.5, 2292, 2299, 2299, 2307.5,
                       2316, 2322.5, 2326.5, 2333, 2334, 2343.5, 2345.5, 2346.5, 2349.5, 2350, 2355, 2355, 2358, 2362.5, 2363.5, 2365,
                       2365.5, 2368.5, 2369.5, 2373, 2374.5, 2379.5, 2387.5, 2401, 2402, 2402.5, 2409, 2414, 2422, 2427, 2429.5, 2434,
                       2443.5, 2444.5, 2450.5, 2458.5, 2463.5, 2465, 2475.5, 2495.5]}

ranges = [(400, 995.5), (1000, 1599.5), (1600, 1699.5), (1700, 1799.5), (1800, 1899.5), (1900, 1999.5), (2000, 2499.5)]
labels = [f'{start}-{end}' for start, end in ranges]

plt.rcParams['font.family'] = 'Times New Roman'
plt.rcParams['font.size'] = 18

counters = []
for i, key in enumerate(sorted(selected_bands.keys())):
    bands = selected_bands[key]
    counts = [sum(start <= b <= end for b in bands)/key for start, end in ranges]
    counters.append(counts)


plt.tight_layout()
plt.show()

df = np.array(counters).T
range_labels = [f"{start}â€“{end}" for start, end in ranges]
plt.figure(figsize=(10, 6))
sns.heatmap(df, annot=True, fmt=".2f", cmap="viridis", cbar_kws={'label': 'Proportion of Selected Bands'})
plt.xlabel("Lower-dimensional Size")
plt.ylabel("Spectral Region (nm)")
plt.yticks(ticks=np.arange(len(range_labels)) + 0.5, labels=range_labels, rotation=0)

plt.tight_layout()
plt.savefig("band_propo.png", dpi=300)
plt.show()
